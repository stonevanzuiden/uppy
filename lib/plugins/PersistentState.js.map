{"version":3,"sources":["../../src/plugins/PersistentState.js"],"names":["Plugin","require","module","exports","core","opts","type","id","title","defaultOptions","loadSavedState","savedState","localStorage","getItem","state","JSON","parse","install","window","onbeforeunload","ev","setItem","stringify"],"mappings":";;;;;;;;;;AAAA,IAAMA,SAASC,QAAQ,UAAR,CAAf;AACA;;AAEA;;;;;;;;AAQAC,OAAOC,OAAP;AAAA;;AACE,2BAAaC,IAAb,EAAmBC,IAAnB,EAAyB;AAAA;;AAAA,iDACvB,mBAAMD,IAAN,EAAYC,IAAZ,CADuB;;AAEvB,UAAKC,IAAL,GAAY,UAAZ;AACA,UAAKC,EAAL,GAAU,kBAAV;AACA,UAAKC,KAAL,GAAa,iBAAb;;AAEA;AACA,QAAMC,iBAAiB,EAAvB;;AAEA;AACA,UAAKJ,IAAL,GAAY,SAAc,EAAd,EAAkBI,cAAlB,EAAkCJ,IAAlC,CAAZ;AAVuB;AAWxB;;AAZH,4BAcEK,cAdF,6BAcoB;AAChB,QAAMC,aAAaC,aAAaC,OAAb,CAAqB,WAArB,CAAnB;;AAEA,QAAIF,UAAJ,EAAgB;AACd,WAAKP,IAAL,CAAUU,KAAV,GAAkBC,KAAKC,KAAL,CAAWL,UAAX,CAAlB;AACD;AACF,GApBH;;AAAA,4BAsBEM,OAtBF,sBAsBa;AAAA;;AACT,SAAKP,cAAL;;AAEAQ,WAAOC,cAAP,GAAwB,UAACC,EAAD,EAAQ;AAC9BR,mBAAaS,OAAb,CAAqB,WAArB,EAAkCN,KAAKO,SAAL,CAAe,OAAKlB,IAAL,CAAUU,KAAzB,CAAlC;AACD,KAFD;;AAIA;AACA;AACA;AACD,GAhCH;;AAAA;AAAA,EAA+Cd,MAA/C","file":"PersistentState.js","sourcesContent":["const Plugin = require('./Plugin')\n// import deepDiff from 'deep-diff'\n\n/**\n * Persistent State\n *\n * Helps debug Uppy: loads saved state from localStorage, so when you restart the page,\n * your state is right where you left off. If something goes wrong, clear uppyState\n * in your localStorage, using the devTools\n *\n */\nmodule.exports = class PersistentState extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.type = 'debugger'\n    this.id = 'Persistent State'\n    this.title = 'PersistentState'\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n  }\n\n  loadSavedState () {\n    const savedState = localStorage.getItem('uppyState')\n\n    if (savedState) {\n      this.core.state = JSON.parse(savedState)\n    }\n  }\n\n  install () {\n    this.loadSavedState()\n\n    window.onbeforeunload = (ev) => {\n      localStorage.setItem('uppyState', JSON.stringify(this.core.state))\n    }\n\n    // this.core.on('core:state-update', (prev, state, patch) => {\n    //   localStorage.setItem('uppyState', JSON.stringify(state))\n    // })\n  }\n}\n"]}