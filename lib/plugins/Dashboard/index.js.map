{"version":3,"sources":["../../../src/plugins/Dashboard/index.js"],"names":["Plugin","require","Translator","dragDrop","Dashboard","getSpeed","getETA","prettyETA","findDOMElement","prettyBytes","defaultTabIcon","module","exports","core","opts","id","title","type","defaultLocale","strings","selectToUpload","closeModal","upload","importFrom","dashboardWindowTitle","dashboardTitle","copyLinkToClipboardSuccess","copyLinkToClipboardFallback","done","localDisk","dropPasteImport","dropPaste","browse","fileProgress","numberOfSelectedFiles","uploadAllNewFiles","defaultOptions","target","inline","width","height","semiTransparent","showProgressDetails","locale","translator","containerWidth","translate","bind","hideModal","showModal","addTarget","actions","hideAllPanels","showPanel","initEvents","handleEscapeKeyPress","handleFileCard","handleDrop","pauseAll","resumeAll","cancelAll","updateDashboardElWidth","render","install","plugin","callerPluginId","constructor","name","callerPluginName","callerPluginIcon","icon","callerPluginType","msg","log","focus","isHidden","modal","getState","newTargets","targets","slice","push","setState","activePanel","filter","document","body","classList","remove","add","querySelector","setTimeout","event","keyCode","showModalTrigger","trigger","addEventListener","removeDragDropListener","el","files","removeEvents","removeEventListener","bus","on","window","removeActions","off","dashboardEl","offsetWidth","console","fileId","fileCardFor","forEach","file","emit","source","data","getTotalSpeed","totalSpeed","progress","getTotalETA","totalSeconds","state","newFiles","Object","keys","uploadStarted","uploadStartedFiles","completeFiles","uploadComplete","inProgressFiles","isPaused","inProgressFilesArray","totalETA","totalSize","totalUploadedSize","bytesTotal","bytesUploaded","isAllComplete","totalProgress","isAllPaused","length","isUploadStarted","acquirers","progressindicators","addFile","emitter","removeFile","fileID","startUpload","ev","catch","err","error","stack","message","pauseUpload","cancelUpload","showFileCard","fileCardDone","meta","info","text","duration","resumableUploads","capabilities","totalFileCount","inProgress","autoProceed","onPaste","handlePaste","i18n","metaFields","maxWidth","maxHeight","currentWidth","isWide","mount","uninstall","unmount"],"mappings":"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","file":"index.js","sourcesContent":["const Plugin = require('../Plugin')\nconst Translator = require('../../core/Translator')\nconst dragDrop = require('drag-drop')\nconst Dashboard = require('./Dashboard')\nconst { getSpeed } = require('../../core/Utils')\nconst { getETA } = require('../../core/Utils')\nconst { prettyETA } = require('../../core/Utils')\nconst { findDOMElement } = require('../../core/Utils')\nconst prettyBytes = require('prettier-bytes')\nconst { defaultTabIcon } = require('./icons')\n\n/**\n * Modal Dialog & Dashboard\n */\nmodule.exports = class DashboardUI extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.id = 'DashboardUI'\n    this.title = 'Dashboard UI'\n    this.type = 'orchestrator'\n\n    const defaultLocale = {\n      strings: {\n        selectToUpload: 'Select files to upload',\n        closeModal: 'Close Modal',\n        upload: 'Upload',\n        importFrom: 'Import files from',\n        dashboardWindowTitle: 'Uppy Dashboard Window (Press escape to close)',\n        dashboardTitle: 'Uppy Dashboard',\n        copyLinkToClipboardSuccess: 'Link copied to clipboard.',\n        copyLinkToClipboardFallback: 'Copy the URL below',\n        done: 'Done',\n        localDisk: 'Local Disk',\n        dropPasteImport: 'Drop files here, paste, import from one of the locations above or',\n        dropPaste: 'Drop files here, paste or',\n        browse: 'browse',\n        fileProgress: 'File progress: upload speed and ETA',\n        numberOfSelectedFiles: 'Number of selected files',\n        uploadAllNewFiles: 'Upload all new files'\n      }\n    }\n\n    // set default options\n    const defaultOptions = {\n      target: 'body',\n      inline: false,\n      width: 750,\n      height: 550,\n      semiTransparent: false,\n      defaultTabIcon: defaultTabIcon(),\n      showProgressDetails: false,\n      locale: defaultLocale\n    }\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n\n    this.locale = Object.assign({}, defaultLocale, this.opts.locale)\n    this.locale.strings = Object.assign({}, defaultLocale.strings, this.opts.locale.strings)\n\n    this.translator = new Translator({locale: this.locale})\n    this.containerWidth = this.translator.translate.bind(this.translator)\n\n    this.hideModal = this.hideModal.bind(this)\n    this.showModal = this.showModal.bind(this)\n\n    this.addTarget = this.addTarget.bind(this)\n    this.actions = this.actions.bind(this)\n    this.hideAllPanels = this.hideAllPanels.bind(this)\n    this.showPanel = this.showPanel.bind(this)\n    this.initEvents = this.initEvents.bind(this)\n    this.handleEscapeKeyPress = this.handleEscapeKeyPress.bind(this)\n    this.handleFileCard = this.handleFileCard.bind(this)\n    this.handleDrop = this.handleDrop.bind(this)\n    this.pauseAll = this.pauseAll.bind(this)\n    this.resumeAll = this.resumeAll.bind(this)\n    this.cancelAll = this.cancelAll.bind(this)\n    this.updateDashboardElWidth = this.updateDashboardElWidth.bind(this)\n    this.render = this.render.bind(this)\n    this.install = this.install.bind(this)\n  }\n\n  addTarget (plugin) {\n    const callerPluginId = plugin.id || plugin.constructor.name\n    const callerPluginName = plugin.title || callerPluginId\n    const callerPluginIcon = plugin.icon || this.opts.defaultTabIcon\n    const callerPluginType = plugin.type\n\n    if (callerPluginType !== 'acquirer' &&\n        callerPluginType !== 'progressindicator' &&\n        callerPluginType !== 'presenter') {\n      let msg = 'Error: Modal can only be used by plugins of types: acquirer, progressindicator, presenter'\n      this.core.log(msg)\n      return\n    }\n\n    const target = {\n      id: callerPluginId,\n      name: callerPluginName,\n      icon: callerPluginIcon,\n      type: callerPluginType,\n      focus: plugin.focus,\n      render: plugin.render,\n      isHidden: true\n    }\n\n    const modal = this.core.getState().modal\n    const newTargets = modal.targets.slice()\n    newTargets.push(target)\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        targets: newTargets\n      })\n    })\n\n    return this.target\n  }\n\n  hideAllPanels () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({modal: Object.assign({}, modal, {\n      activePanel: false\n    })})\n  }\n\n  showPanel (id) {\n    const modal = this.core.getState().modal\n\n    const activePanel = modal.targets.filter((target) => {\n      return target.type === 'acquirer' && target.id === id\n    })[0]\n\n    this.core.setState({modal: Object.assign({}, modal, {\n      activePanel: activePanel\n    })})\n  }\n\n  hideModal () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        isHidden: true\n      })\n    })\n\n    document.body.classList.remove('is-UppyDashboard-open')\n  }\n\n  showModal () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        isHidden: false\n      })\n    })\n\n    // add class to body that sets position fixed\n    document.body.classList.add('is-UppyDashboard-open')\n    // focus on modal inner block\n    this.target.querySelector('.UppyDashboard-inner').focus()\n\n    this.updateDashboardElWidth()\n    // to be sure, sometimes when the function runs, container size is still 0\n    setTimeout(this.updateDashboardElWidth, 300)\n  }\n\n  // Close the Modal on esc key press\n  handleEscapeKeyPress (event) {\n    if (event.keyCode === 27) {\n      this.hideModal()\n    }\n  }\n\n  initEvents () {\n    // const dashboardEl = this.target.querySelector(`${this.opts.target} .UppyDashboard`)\n\n    // Modal open button\n    const showModalTrigger = findDOMElement(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.addEventListener('click', this.showModal)\n    } else {\n      this.core.log('Modal trigger wasnâ€™t found')\n    }\n\n    document.body.addEventListener('keyup', this.handleEscapeKeyPress)\n\n    // Drag Drop\n    this.removeDragDropListener = dragDrop(this.el, (files) => {\n      this.handleDrop(files)\n    })\n  }\n\n  removeEvents () {\n    const showModalTrigger = findDOMElement(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.removeEventListener('click', this.showModal)\n    }\n\n    this.removeDragDropListener()\n    document.body.removeEventListener('keyup', this.handleEscapeKeyPress)\n  }\n\n  actions () {\n    const bus = this.core.bus\n\n    bus.on('core:file-add', this.hideAllPanels)\n    bus.on('dashboard:file-card', this.handleFileCard)\n\n    window.addEventListener('resize', this.updateDashboardElWidth)\n\n    // bus.on('core:success', (uploadedCount) => {\n    //   bus.emit(\n    //     'informer',\n    //     `${this.core.i18n('files', {'smart_count': uploadedCount})} successfully uploaded, Sir!`,\n    //     'info',\n    //     6000\n    //   )\n    // })\n  }\n\n  removeActions () {\n    const bus = this.core.bus\n\n    window.removeEventListener('resize', this.updateDashboardElWidth)\n\n    bus.off('core:file-add', this.hideAllPanels)\n    bus.off('dashboard:file-card', this.handleFileCard)\n  }\n\n  updateDashboardElWidth () {\n    const dashboardEl = this.target.querySelector('.UppyDashboard-inner')\n    const containerWidth = dashboardEl.offsetWidth\n    console.log(containerWidth)\n\n    const modal = this.core.getState().modal\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        containerWidth: dashboardEl.offsetWidth\n      })\n    })\n  }\n\n  handleFileCard (fileId) {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        fileCardFor: fileId || false\n      })\n    })\n  }\n\n  handleDrop (files) {\n    this.core.log('All right, someone dropped something...')\n\n    files.forEach((file) => {\n      this.core.bus.emit('core:file-add', {\n        source: this.id,\n        name: file.name,\n        type: file.type,\n        data: file\n      })\n    })\n  }\n\n  cancelAll () {\n    this.core.bus.emit('core:cancel-all')\n  }\n\n  pauseAll () {\n    this.core.bus.emit('core:pause-all')\n  }\n\n  resumeAll () {\n    this.core.bus.emit('core:resume-all')\n  }\n\n  getTotalSpeed (files) {\n    let totalSpeed = 0\n    files.forEach((file) => {\n      totalSpeed = totalSpeed + getSpeed(file.progress)\n    })\n    return totalSpeed\n  }\n\n  getTotalETA (files) {\n    let totalSeconds = 0\n\n    files.forEach((file) => {\n      totalSeconds = totalSeconds + getETA(file.progress)\n    })\n\n    return totalSeconds\n  }\n\n  render (state) {\n    const files = state.files\n\n    const newFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadStarted\n    })\n    const uploadStartedFiles = Object.keys(files).filter((file) => {\n      return files[file].progress.uploadStarted\n    })\n    const completeFiles = Object.keys(files).filter((file) => {\n      return files[file].progress.uploadComplete\n    })\n    const inProgressFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadComplete &&\n             files[file].progress.uploadStarted &&\n             !files[file].isPaused\n    })\n\n    let inProgressFilesArray = []\n    inProgressFiles.forEach((file) => {\n      inProgressFilesArray.push(files[file])\n    })\n\n    const totalSpeed = prettyBytes(this.getTotalSpeed(inProgressFilesArray))\n    const totalETA = prettyETA(this.getTotalETA(inProgressFilesArray))\n\n    // total size and uploaded size\n    let totalSize = 0\n    let totalUploadedSize = 0\n    inProgressFilesArray.forEach((file) => {\n      totalSize = totalSize + (file.progress.bytesTotal || 0)\n      totalUploadedSize = totalUploadedSize + (file.progress.bytesUploaded || 0)\n    })\n    totalSize = prettyBytes(totalSize)\n    totalUploadedSize = prettyBytes(totalUploadedSize)\n\n    const isAllComplete = state.totalProgress === 100\n    const isAllPaused = inProgressFiles.length === 0 && !isAllComplete && uploadStartedFiles.length > 0\n    const isUploadStarted = uploadStartedFiles.length > 0\n\n    const acquirers = state.modal.targets.filter((target) => {\n      return target.type === 'acquirer'\n    })\n\n    const progressindicators = state.modal.targets.filter((target) => {\n      return target.type === 'progressindicator'\n    })\n\n    const addFile = (file) => {\n      this.core.emitter.emit('core:file-add', file)\n    }\n\n    const removeFile = (fileID) => {\n      this.core.emitter.emit('core:file-remove', fileID)\n    }\n\n    const startUpload = (ev) => {\n      this.core.upload().catch((err) => {\n        // Log error.\n        console.error(err.stack || err.message)\n      })\n    }\n\n    const pauseUpload = (fileID) => {\n      this.core.emitter.emit('core:upload-pause', fileID)\n    }\n\n    const cancelUpload = (fileID) => {\n      this.core.emitter.emit('core:upload-cancel', fileID)\n      this.core.emitter.emit('core:file-remove', fileID)\n    }\n\n    const showFileCard = (fileID) => {\n      this.core.emitter.emit('dashboard:file-card', fileID)\n    }\n\n    const fileCardDone = (meta, fileID) => {\n      this.core.emitter.emit('core:update-meta', meta, fileID)\n      this.core.emitter.emit('dashboard:file-card')\n    }\n\n    const info = (text, type, duration) => {\n      this.core.emitter.emit('informer', text, type, duration)\n    }\n\n    const resumableUploads = this.core.getState().capabilities.resumableUploads || false\n\n    return Dashboard({\n      state: state,\n      modal: state.modal,\n      newFiles: newFiles,\n      files: files,\n      totalFileCount: Object.keys(files).length,\n      isUploadStarted: isUploadStarted,\n      inProgress: uploadStartedFiles.length,\n      completeFiles: completeFiles,\n      inProgressFiles: inProgressFiles,\n      totalSpeed: totalSpeed,\n      totalETA: totalETA,\n      totalProgress: state.totalProgress,\n      totalSize: totalSize,\n      totalUploadedSize: totalUploadedSize,\n      isAllComplete: isAllComplete,\n      isAllPaused: isAllPaused,\n      acquirers: acquirers,\n      activePanel: state.modal.activePanel,\n      progressindicators: progressindicators,\n      autoProceed: this.core.opts.autoProceed,\n      id: this.id,\n      hideModal: this.hideModal,\n      showProgressDetails: this.opts.showProgressDetails,\n      inline: this.opts.inline,\n      semiTransparent: this.opts.semiTransparent,\n      onPaste: this.handlePaste,\n      showPanel: this.showPanel,\n      hideAllPanels: this.hideAllPanels,\n      log: this.core.log,\n      bus: this.core.emitter,\n      i18n: this.containerWidth,\n      pauseAll: this.pauseAll,\n      resumeAll: this.resumeAll,\n      cancelAll: this.cancelAll,\n      addFile: addFile,\n      removeFile: removeFile,\n      info: info,\n      metaFields: state.metaFields,\n      resumableUploads: resumableUploads,\n      startUpload: startUpload,\n      pauseUpload: pauseUpload,\n      cancelUpload: cancelUpload,\n      fileCardFor: state.modal.fileCardFor,\n      showFileCard: showFileCard,\n      fileCardDone: fileCardDone,\n      updateDashboardElWidth: this.updateDashboardElWidth,\n      maxWidth: this.opts.maxWidth,\n      maxHeight: this.opts.maxHeight,\n      currentWidth: state.modal.containerWidth,\n      isWide: state.modal.containerWidth > 400\n    })\n  }\n\n  install () {\n    // Set default state for Modal\n    this.core.setState({modal: {\n      isHidden: true,\n      showFileCard: false,\n      activePanel: false,\n      targets: []\n    }})\n\n    const target = this.opts.target\n    const plugin = this\n    this.target = this.mount(target, plugin)\n\n    this.initEvents()\n    this.actions()\n  }\n\n  uninstall () {\n    this.unmount()\n    this.removeActions()\n    this.removeEvents()\n  }\n}\n"]}